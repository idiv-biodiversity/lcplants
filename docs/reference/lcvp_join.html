<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Join two data.frames using the Leipzig Catalogue of Plants (LCVP) — lcvp_join • lcvplants</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Join two data.frames using the Leipzig Catalogue of Plants (LCVP) — lcvp_join"><meta property="og:description" content='Join two data.frames based on the taxonomic resolution of plant taxa names
listed in the "Leipzig Catalogue of Vascular Plants" (LCVP). Inspired by the
dplyr:join function.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lcvplants</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Parallel-name-harmonization.html">How to run lcvplants in parallel</a>
    </li>
    <li>
      <a href="../articles/taxonomic_resolution_using_lcvplants.html">Taxonomic resolution using lcvplants</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/idiv-biodiversity/lcvplants/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Join two data.frames using the Leipzig Catalogue of Plants (LCVP)</h1>
    <small class="dont-index">Source: <a href="https://github.com/idiv-biodiversity/lcvplants/blob/HEAD/R/lcvp_join.R" class="external-link"><code>R/lcvp_join.R</code></a></small>
    <div class="hidden name"><code>lcvp_join.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Join two data.frames based on the taxonomic resolution of plant taxa names
listed in the "Leipzig Catalogue of Vascular Plants" (LCVP). Inspired by the
<code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">dplyr:join</a></code> function.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">lcvp_join</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">sp_columns</span>,</span>
<span>  max_distance <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  genus_fuzzy <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  grammar_check <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"full"</span>,</span>
<span>  solve_duplicated <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  func_numeric <span class="op">=</span> <span class="va">mean</span>,</span>
<span>  func_character <span class="op">=</span> <span class="va">.keep_all</span>,</span>
<span>  func_logical <span class="op">=</span> <span class="va">any</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x, y</dt>
<dd><p>data.frames to join.</p></dd>


<dt>sp_columns</dt>
<dd><p>A character vector indicating the column names in x and y
with respective species names to join by.</p>
<p>For example, c("species", "Species_name").</p></dd>


<dt>max_distance</dt>
<dd><p>It represents the maximum string distance allowed for a
match when comparing the submitted name with the closest name matches in the
LCVP. The distance used is a generalized Levenshtein distance that indicates
the total number of insertions, deletions, and substitutions allowed to
match the two names. It can be expressed as an integer or as the fraction of
the binomial name. For example, a name with length 10, and a max_distance =
0.1, allow only one change (insertion, deletion, or substitution). A
max_distance = 2, allows two changes.</p></dd>


<dt>genus_fuzzy</dt>
<dd><p>If TRUE, the fuzzy match algorithm based on max_distance
will also be applied to the genus (note that this may considerably increase
computational time). If FALSE, fuzzy match will only apply to the epithet.</p></dd>


<dt>grammar_check</dt>
<dd><p>if TRUE, the algorithm will try to fix common latin
grammar mistakes.</p></dd>


<dt>type</dt>
<dd><p>What type of join should be done: "full" (default), "left",
"right" or "inner". * "full" return all rows and all columns from both x and
y. * "left" return all rows from x. * "right" return all rows from y. *
"inner" return all rows from x where there are matching species in y.</p></dd>


<dt>solve_duplicated</dt>
<dd><p>if TRUE, it will summarize duplicated output names
given a function for each column class.</p>
<p>See <code><a href="lcvp_solve_dups.html">lcvp_solve_dups</a></code> for details.</p></dd>


<dt>func_numeric</dt>
<dd><p>A function to summarize numeric columns if
solve_duplicated = TRUE. Default will return the mean.</p></dd>


<dt>func_character</dt>
<dd><p>A function to summarize character columns if
solve_duplicated = TRUE. Default will keep all unique strings separated by
comma.</p></dd>


<dt>func_logical</dt>
<dd><p>A function to summarize logical columns if
solve_duplicated = TRUE. Default will return TRUE if any is TRUE.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A data.frame with the columns in both tables. The rows will depend on
the <code>type</code> selected. For "inner", a subset of x rows. For "left", all x
rows. For "right", a subset of x rows, followed by unmatched y rows. For
"full", all x rows, followed by unmatched y rows.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The function add the columns from y to x based on the list of species
name in both tables. It first standardizes the species names in both tables
based on the "Leipzig Catalogue of Vascular Plants" (LCVP) using the algorithm
in <code><a href="lcvp_search.html">lcvp_search</a></code>. Note that
<code>lcvp_join</code> can also deal with misspelling by fuzzy matching species name
given a <code>max_distance</code> choice. These standardized names of both tables
are then matched using the algorithm in
<code><a href="lcvp_match.html">lcvp_match</a></code>. The type "full" join will keep
all species and add NAs to missing values. No NA is added in "inner", "left"
and "right" options.</p>
<p>Duplicated taxonomic resolution may occur if two inputs are now synonyms. If
<code>solve_duplicated</code> is <code>TRUE</code> the
<code><a href="lcvp_match.html">lcvp_solve_dups</a></code> function is applied to
merge duplicated output names.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Freiberg, M., Winter, M., Gentile, A. et al. LCVP, The Leipzig
catalogue of vascular plants, a new taxonomic reference list for all known
vascular plants. Sci Data 7, 416 (2020).
https://doi.org/10.1038/s41597-020-00702-z</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="lcvp_search.html">lcvp_search</a></code>,
<code><a href="lcvp_match.html">lcvp_match</a></code>,
<code><a href="lcvp_solve_dups.html">lcvp_solve_dups</a></code>.</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Bruno Vilela &amp; Alexander Ziska</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># Ensure that LCVP package is available before running the example.</span></span>
<span><span class="co"># If it is not, see the `lcvplants` package vignette for details</span></span>
<span><span class="co"># on installing the required data package.</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"LCVP"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> <span class="co"># Do not run this</span></span>
<span></span>
<span><span class="co"># Create data.frame1</span></span>
<span><span class="va">splist1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fu">LCVP</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/LCVP/man/tab_lcvp.html" class="external-link">tab_lcvp</a></span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="fl">1</span>, <span class="va">paste</span>, collapse <span class="op">=</span> <span class="st">" "</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Species"</span> <span class="op">=</span> <span class="va">splist1</span>, <span class="st">"Trait1"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">splist1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create data.frame2</span></span>
<span><span class="va">splist2</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fu">LCVP</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/LCVP/man/tab_lcvp.html" class="external-link">tab_lcvp</a></span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="fl">1</span>, <span class="va">paste</span>, collapse <span class="op">=</span> <span class="st">" "</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Species"</span> <span class="op">=</span> <span class="va">splist2</span>,</span>
<span><span class="st">"Trait2"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">splist2</span><span class="op">)</span><span class="op">)</span>,</span>
<span><span class="st">"Trait3"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">splist2</span><span class="op">)</span><span class="op">)</span>,</span>
<span><span class="st">"Trait4"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">splist2</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span><span class="st">"Trait5"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">splist2</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Full join</span></span>
<span><span class="fu">lcvp_join</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Species"</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"full"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Left join</span></span>
<span><span class="fu">lcvp_join</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Species"</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Right join</span></span>
<span><span class="fu">lcvp_join</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Species"</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Inner join and solve duplicates</span></span>
<span><span class="fu">lcvp_join</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Species"</span><span class="op">)</span>,</span>
<span>type <span class="op">=</span> <span class="st">"inner"</span>, solve_duplicated <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span></code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Bruno 0000-0003-4072-0558 Vilela, Alessandro Gentile, Martin Freiberg, Marten Winter.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

